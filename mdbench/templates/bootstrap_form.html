{% extends "base_generic.html" %}

{%block content%}
<div class="card border-0 text-left pt-4" style="background-image: url('https://mdbench.ace-net.ca/static/media/images/fig3.png'); border-radius: 0;">
    <div class="card-title">
        <h3>FILTERS</h3>
    </div>
    <div class="card-body">
    <form method='GET' action = '.'>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">
                    <div class="input-group">
                        <div class="input">
                            <label for="software_contains" class="form-label">Software name</label>
                            <input class="mb-1 form-control form-control-sm" spellcheck="false" style="background-color: #b7b796;" type="search" name = "software_contains" placeholder="namd2 .."/>
                        </div>            
                    </div>
                </div>
            </div>

        <div class="col-sm-3">
            <div class="form-group">
                <div class="input-group">
                    <div class="input" >
                        <label for="module_contains" class="form-label">Module name</label>
                       <input class="mb-1 form-control form-control-sm" spellcheck="false" style="background-color: #b7b796;"  type="search" name = "module_contains" placeholder="namd-ucx .."/>
                    </div>            
                </div>
            </div>
        </div>

       <div class="col-sm-3">
            <div class="form-group">
                <div class="input-group">
                    <div class="input" >
                        <label for="module_version" class="form-label">Module version</label>
                        <input class="mb-1 form-control form-control-sm" spellcheck="false" style="background-color: #b7b796;"  type="search" name = "module_version" placeholder="2.14 .."/>
                    </div>            
                </div>
            </div>
         </div>

        <div class="col-sm-3">
             <div class="form-group">
                <div class="input-group">
                    <div class="input">
                    <label for="site_comtains" class="form-label">Cluster</label>
                    <input class="mb-1 form-control form-control-sm" spellcheck="false" style="background-color: #b7b796;"  type="search" name = "site_contains" placeholder="Narval .."/>
                    </div>            
                </div>
            </div>
        </div>
    </div>

    <div class="row">
            <div class="col-sm-3">
             <div class="form-group">
                 <div class="input-group">
                    <div class="input">
                       <label for="gpu_model" class="form-label">GPU model</label>
                        <input class="mb-1 form-control form-control-sm" spellcheck="false" style="background-color: #b7b796;"  type="search" name = "gpu_model" placeholder="V100 .."/>
                    </div>            
                </div>
            </div>
        </div>

            <div class="col-sm-3">
             <div class="form-group">
                 <div class="input-group">
                    <div class="input">
                       <label for="gpu_model" class="form-label">CPU model</label>
                        <input class="mb-1 form-control form-control-sm" spellcheck="false" style="background-color: #b7b796;"  type="search" name = "cpu_model" placeholder="6148 .."/>
                    </div>            
                </div>
            </div>
        </div>

        <div class="col-sm-3">
             <div class="form-group">
                 <div class="input-group">
                    <div class="input">
                       <label for="arch" class="form-label">Instruction set</label>
                        <input class="mb-1 form-control form-control-sm" spellcheck="false" style="background-color: #b7b796;"  type="search" name = "arch" placeholder="avx2 .."/>
                    </div>            
                </div>
            </div>
        </div>

        <div class="col-sm-3">
            <div class="form-group">
                <div class="input-group">
                    <div class="input">
                        <label for="dataset" class="form-label">Dataset</label>
                        <input class="mb-1 form-control form-control-sm" spellcheck="false" style="background-color: #b7b796;"  type="search" name = "dataset" placeholder="6n4o .."/>
                    </div>            
                </div>
            </div>
        </div>


        <div class="row my-2">
          <div class="col-sm-1">
            <button class="btn btn-sm btn-outline-light" type="submit"><i class="fa fa-search"></i></button>
          </div>
          <div class="col-sm-9 py-1">
           <p style="color: #85b737;">APPLIED FILTERS: {{querystr}}</p>
          </div>
          
          <div class="col-sm-2">
            <button class="btn btn-sm btn-outline-light px-2"> <a style="color: #ccc" href="{% url 'export' %}">Download.csv</a> </button> 
            {{ csv_file }}
          </div>
         </div>
        </div>
      </form>
    </div>
  </div>
</div>

{% endblock content%}

{% block content2%}

<div class="row gx-0" style="background-color: #eee;">
  <div class="col-sm-4">
    <div class="container-fluid pt-3">
      <div class="row justify-content-center">
        <div class="col-auto" >
          <div class="card border-0" style="background-color: #eee;">
            <div class="card-body">
                <h3 class="card-title" >ACCESSING THE DATABASE</h3>
               <div class="card-text">
                </p>When this page is viewed no filters are initially applied. All benchmarks are selected and sorted by simulation speed. The chart on the right displays only top 20 benchmarks for clarity.</p>  
                <p>A subset of benchmarks can be selected using a custom chain of filters. Search fields are case insensitive and can be abbreviated.</p>
                <p> Selected database entries can be downloaded as CSV files for further analysis or viewed in the Table below.</p>
                <p> Efficiency = PS/(SS * N) where PS is speed of the parallel program, SS is speed of the serial program, and N is the number of CPUs or GPUs<p>               
               </div>   
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-sm-8">
    <div class="container-fluid pt-3">
      <div class="row justify-content-center"
        <div class="col-auto" >
          <div class="card border-0" style="background-color: #eee;" >
            <div class="card-body">
              <h3 class="card-title">Simulation Speed</h3>
                <div class="card-img-top">
                  {% autoescape off %} {{ plot_div }} {% endautoescape %}
                </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row gx-0" style="background-color: #fff">

  <div class="col-sm-8"> 
    <div style="background-color: #fff">
      <div class="container-fluid pt-3">
        <div class="row justify-content-center">
          <div class="col-auto" >
            <div class="card border-0" style="background-color: #fff;" >
              <div class="card-body">
                <h3 class="card-title" style="color: #B79754;">Cost of Simulations Using GPUs</h3>
                  <div class="card-img-top">
                    {% autoescape off %} {{ plot_div_cost_gpu }} {% endautoescape %}
                  </div>
              </div>
            </div>
          </div>
        </div>
      </div>
   </div>
</div>

  <div class="col-sm-4">
    <div class="container-fluid pt-3">
      <div class="row justify-content-center">
        <div class="col-auto" >
          <div class="card border-0" style="background-color: #fff;">
            <div class="card-body">
                <h3 class="card-title" style="color: #B79754;">SIMULATIONS ON MULTIPLE GPUS</h3>
               <div class="card-text">
                </p>Parallel scaling to multiple GPUs strongly depends on the compibation of software, hardware and simulation parameters. Often simulations do not run faster even on two GPUs. For example, search for namd2.cuda in "Software name" and Cedar in "Cluster".</p>  
                <p> Simulations on nodes with direct interconnect between GPUs (NVLink) may benefit from multiple GPUs, but efficiency decreases and cost goes up with the number of GPUs. Example: pmemd.cuda, narval</p>
               </div>   
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row gx-0" style="background-color: #eee">

  <div class="col-sm-4">
    <div class="container-fluid pt-3">
      <div class="row justify-content-center">
        <div class="col-auto" >
          <div class="card border-0" style="background-color: #eee;">
            <div class="card-body">
                <h4 class="card-title" style="color: #B79754;">SIMULATIONS ON MULTIPLE CPUS</h4>
               <div class="card-text">
                </p>Simulations using CPUs reach performance comparable to GPU only with hundreds of cores used. It is not uncommon for simulations to wait in the queue for up to several days for such a significant resource to be available.</p>  
               </div>   
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-sm-8">
    <div style="background-color: #eee">
      <div class="container-fluid pt-3">
        <div class="row justify-content-center">
          <div class="col-auto" >
            <div class="card border-0" style="background-color: #eee" >
              <div class="card-body">
                <h3 class="card-title" style="color: #B79754;">Cost of Simulations Using CPUs</h3>
                  <div class="card-img-top">
                    {% autoescape off %}
                    {{ plot_div_cost_cpu }}
                    {% endautoescape %}
                  </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


</div>


<div style="background-color:  #222529">
    <div class="container-fluid pt-3">
        <div class="row justify-content-center">
            <div class="col-auto" >
                <div class="card" style="background-color: #35754c;">
                    <div class="card-body">
                        <div class="card-title"><h3>BENCHMARK DETAILS</h3>
                        <button class="btn btn-sm btn-outline-light"> <a style="color: #aaa" href="{% url 'export' %}">Download CSV</a> </button> </div>
                        {{ csv_file }}
                         <div style="background-color: #eee;">
                             <table class="table table-hover">
                                 {% include "mdbench/t_head.html" %}
                                 {% for benchmark in queryset %}
                                 <tr>
                                     {% include "mdbench/t_data.html" %}
                                 </tr>   
                                 {% endfor %} 
                             </table>
                         </div>   
                   </div>
               </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

